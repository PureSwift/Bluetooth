name: Swift ARM
on: [push]
jobs:

    macos:
      name: Baremetal Embedded ARM 
      runs-on: ubuntu-latest
      container: swiftlang/swift:nightly-jammy
      steps:
      - name: Install dependencies
        run: apt update -y; apt install libtool-bin -y;
      - name: Checkout
        uses: actions/checkout@v2
      - name: Swift Version
        run: swift --version
      - name: Build Bluetooth
        run: SWIFTPM_ENABLE_MACROS=0 SWIFTPM_ENABLE_PLUGINS=0 SWIFTPM_BLUETOOTH_METADATA=0 swift build --triple armv6m-apple-none-macho --configuration release --verbose -Xswiftc -enable-experimental-feature -Xswiftc Embedded -Xswiftc -disable-stack-protector -Xcc -D__MACH__ -Xcc -ffreestanding -Xcc -mcpu=cortex-m0plus -Xcc -mthumb --target Bluetooth
      - name: Build BluetoothGAP
        run: SWIFTPM_ENABLE_MACROS=0 SWIFTPM_ENABLE_PLUGINS=0 SWIFTPM_BLUETOOTH_METADATA=0 swift build --triple armv6m-apple-none-macho --configuration release --verbose -Xswiftc -enable-experimental-feature -Xswiftc Embedded -Xswiftc -disable-stack-protector -Xcc -D__MACH__ -Xcc -ffreestanding -Xcc -mcpu=cortex-m0plus -Xcc -mthumb --target BluetoothGAP
